<!--Данный шаблон используется для поиска публикаций по заданным параметрам-->
<!--Наследование шаблона от основного файла-->
{% extends 'default.html' %}

<!--Загрузка собственных фильтров из файла custom_filters.py-->
{% load custom_filters %}

<!--Заголовок страницы-->
{% block title %}
Search tightnings
{% endblock title %}

<!--Описание содержания страницы-->
{% block content %}
    <h1>Поиск данных</h1>
    <hr>
    <h5>Дата вводится в формате: 2021-11-03</h5>
    <!-- Перед таблицей добавим форму для поиска -->
    <form method="GET">
        {% csrf_token %}
        <table>
            <tr>
                <td>
                    <p align="left">
                        Гайковерт
                    </p>
                </td>
                <td>
                    <p align="left">
                        {{ filter.form.nutrunner }}
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p align="left">
                        VIN
                    </p>
                </td>
                <td>
                    <p align="left">
                        {{ filter.form.vin__vin_number }}
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p align="left">
                        Модель
                    </p>
                </td>
                <td>
                    <p align="left">
                        {{ filter.form.vin__model }}
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p align="left">
                        Дата/Время затяжки
                    </p>
                </td>
                <td>
                    <p align="left">
                        {{ filter.form.time_of_creation }}
                    </p>
                </td>
            </tr>
            <tr>
                <td>
                    <p align="left">
                        Статус печати
                    </p>
                </td>
                <td>
                    <p align="left">
                        {{ filter.form.printing }}
                    </p>
                </td>
            </tr>
        </table>
        <p align="left">
            <input type="submit" value="  Найти  ">
        </p>
    </form>
    <hr>
    <!--Если публикации есть, то выводятся поля для поиска-->
    {% if tightings_search %}
       <table align="center">
           <thead>
           <th>
               <b> VIN </b>
           </th>
           <th>
               <b> Модель </b>
           </th>
           <th>
               <b> Дата </b>
           </th>
           <th>
               <b> Время &nbsp </b>
           </th>
           <th>
               <b> &nbsp Гайковерт </b>
           </th>
           <th>
               <b> Чек </b>
           </th>
           </thead>
      {% for tightening in filter.qs %} <!-- поменяем tightings на filter.qs, т.к. теперь мы забираем уже отобранную по каким-то параметрам информацию -->
          <tr>
              <td>
                  <a href="{% url 'vin_detail' tightening.vin.id %}"><u>{{ tightening.vin }}</u></a> &nbsp
              </td>
              <td>
                   &nbsp {{ tightening.vin.model }} &nbsp
              </td>
              <td>
                  &nbsp {{ tightening.time_of_creation|date:'d.m.Y' }} &nbsp
              </td>
              <td>
                  &nbsp {{ tightening.time_of_creation|time:'H:i' }} &nbsp
              </td>
              <td>
                  &nbsp {{ tightening.nutrunner }} &nbsp
              </td>
              <td>
                  {% if tightening.printing %}
                  &nbsp <font color="00bf00"> Напечатан </font> &nbsp
                  {% else %}
                  &nbsp Не напечатан &nbsp
                  {% endif %}
              </td>
          </tr>
      {% endfor %}
      </table>
    <br>
    <!--если нет затяжек, то выводится сообщение ниже-->
    {% else %}
      <h2>Нет информации о затяжках</h2>
    {% endif %}
{% endblock content %}